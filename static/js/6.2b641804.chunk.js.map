{"version":3,"sources":["hooks/useFirebaseAuthState.tsx","hooks/usePageTitle.tsx","components/designsystem/TitledSurface.tsx","components/designsystem/Select.tsx","components/designsystem/SmallInput.tsx","components/designsystem/DefaultPageColumn.ts","hooks/useSupertags.ts","data/encryption.ts","components/designsystem/Setting.tsx","components/widgets/SignIn.tsx","components/preferences/PrefAccount.tsx","components/preferences/PrefAutoPlay.tsx","components/preferences/PrefAutoscrollDelay.tsx","components/preferences/PrefBackends.tsx","components/preferences/PrefHideSeenPosts.tsx","components/preferences/PrefLoadOriginals.tsx","components/preferences/PrefMetadata.tsx","components/preferences/PrefPageSize.tsx","components/preferences/PrefPreloadVideos.tsx","components/preferences/PrefResultsLayout.tsx","components/preferences/PrefShowComments.tsx","components/preferences/PrefShowPostDetails.tsx","hooks/useSupertag.tsx","components/designsystem/SupertagEntry.tsx","components/preferences/PrefSupertags.tsx","components/preferences/PrefTagSuggestions.tsx","components/preferences/PrefTheme.tsx","components/designsystem/StatusImage.tsx","components/widgets/FeatureDetection.tsx","components/widgets/ResetResultsButton.tsx","components/widgets/ResetSeenPostsButton.tsx","components/pages/Preferences.tsx"],"names":["useFirebaseAuthState","authState","setAuthState","useState","user","setUser","useEffect","unsubscribe","firebase","auth","onAuthStateChanged","_unused","usePageTitle","title","React","document","PaddedTitle","styled","Title","_ref","theme","css","_templateObject","_taggedTemplateLiteral","dimensions","hugeSpacing","PaddedSurface","Surface","_ref2","$compact","_templateObject2","bigSpacing","gap","TitledSurface","props","children","className","compact","_jsxs","_Fragment","_jsx","Wrapper","div","blockHeight","StyledSelect","select","defaultInput","Option","option","_templateObject3","defaultBorder","colors","backgroundColor2","defaultBlock","Select","options","value","onChange","Object","entries","map","_ref3","optionKey","optionValue","StyledInput","input","SmallNumberInput","onSubmit","min","max","step","internalValue","setInternalValue","toString","useCallback","event","target","onBlur","Number","blurOnEnter","key","blur","type","onKeyDown","DefaultPageColumn","FlexColumnWithSpacing","centeredMaxWidth","useSupertags","supertags","setSupertags","collection","setCollection","userInfo","email","async","message","msgBuffer","TextEncoder","encode","hashBuffer","crypto","subtle","digest","Array","from","Uint8Array","b","padStart","join","sha256","then","hash","col","firestore","concat","get","snapshot","result","docs","reduce","doc","id","data","catch","err","console","error","onSnapshot","Grid","gridWithGap","SmallTitle","Body","Faded","Control","_templateObject4","Setting","_ref4","description","FlexRow","flexRowWithGap","ProfilePicture","img","borderRadius","SignIn","isSignedIn","handleSignIn","signIn","handleSignOut","signOut","name","displayName","picture","photoURL","FlexColumn","src","alt","PrimaryButton","onClick","SignOutIcon","GoogleIcon","PrefAccount","PrefAutoPlay","autoPlay","setAutoPlay","usePreference","toggleAutoPlay","Toggle","onToggle","PrefAutoscrollDelay","autoscrollDelay","setAutoscrollDelay","BACKEND_TYPES","default","adaptable","render","BACKEND_URLS","PrefBackends","backends","setBackends","preferedBackend","keys","find","includes","_BACKEND_URLS$value","undefined","PrefHideSeenPosts","hideSeen","setHideSeen","toggleHideSeen","PrefLoadOriginals","originals","setOriginals","toggleOriginals","PrefMetadata","showMetadata","setShowMetadata","toggleShowMetadata","PrefPageSize","pageSize","setPageSize","PrefPreloadVideos","preloadVideos","setPreloadVideos","togglePreloadVideos","layouts","infinite_column","pages","PrefResultsLayout","resultsLayout","setResultsLayout","onChangeResultsLayout","PrefShowComments","showComments","setShowComments","toggleShowComments","PrefShowPostDetails","showPostDetails","setShowPostDetails","toggleShowPostDetails","useSupertag","supertag","newTag","tag","newTags","_objectSpread","tags","modifier","setTagsOfSupertag","removeSupertag","flexColumnWithGap","layerBgHighlight","Row","LinkButton","Link","text","SupertagEntry","isOpen","toggleOpen","useToggle","addTag","removeTag","deleteSupertag","tagObjects","useMemo","types","handleRemove","stopPropagation","preventDefault","onTagMenu","isSupertag","order","nextModifer","indexOf","SupertagIcon","length","to","RouteName","SHARE","encodeSupertag","ShareIcon","InvisButton","CloseIcon","TagSelector","showSupertags","TagList","detailed","onTagClick","PrefSupertags","dispatch","useDispatch","openSupertagModal","openModal","ModalId","CREATE_SUPERTAG","PlusIcon","details","PrefTagSuggestions","tagSuggestionsCount","setTagSuggestionsCount","themes","dark","light","coffee","deepsea","PrefTheme","themeId","setThemeId","changeTheme","Positive","SuccessIcon","attrs","color","positive","Negative","FailedIcon","negative","StatusImage","FeatureList","defaultSpacing","backgroundColor","FeatureDetection","supportsGap","supportsFlexGap","supportsAspectRatio","supportsObjectFit","supportsFullscreen","supportsNetworkInformationAPI","supportsLocalStorage","ResetResultsButton","handleClick","setPosts","BlockButton","UndoIcon","ResetSeenPostsButton","onResetSeenPosts","resetSeenPosts","VersionWrapper","Preferences","useTheme","versionString","getVersionString","Header","HorizontalLine","ResetButton","CodeBranchIcon","subduedText"],"mappings":"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","file":"static/js/6.2b641804.chunk.js","sourcesContent":["import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { useEffect, useState } from 'react'\n\n/**\n * A hook that provides the firebase authentication status for use in functional components.\n */\nexport default function useFirebaseAuthState() {\n  const [authState, setAuthState] = useState(false)\n  const [user, setUser] = useState<firebase.User | null>(null)\n\n  useEffect(() => {\n    try {\n      const unsubscribe = firebase\n      .auth()\n      .onAuthStateChanged((user) => {\n        if (user) {\n          setAuthState(true)\n          setUser(user)\n        } else {\n          setAuthState(false)\n          setUser(null)\n        }\n      })\n      return () => {\n        unsubscribe()\n      }\n    } catch {\n      setAuthState(false)\n      setUser(null)\n    }\n  }, [])\n\n  return [authState, user] as const\n}\n","import React from 'react'\n\n/**\n * Effect that sets the title of the page to a specified string.\n * Really small utility hook that saves a few lines.\n */\nexport function usePageTitle(title: string) {\n  React.useEffect(() => {\n    document.title = title\n  }, [title])\n}\n","import React from 'react'\nimport styled, { css, DefaultTheme } from 'styled-components'\nimport { gap } from '../../styled/mixins/gap'\nimport { Surface } from './Surface'\nimport { Title } from './Text'\n\nconst PaddedTitle = styled(Title)(\n  ({ theme }) => css`\n    padding-top: ${theme.dimensions.hugeSpacing};\n  `\n)\n\nconst PaddedSurface = styled(Surface)(\n  ({ theme, $compact }: { theme: DefaultTheme; $compact: boolean }) => css`\n    padding: ${$compact ? theme.dimensions.bigSpacing : theme.dimensions.hugeSpacing};\n    ${gap($compact ? theme.dimensions.bigSpacing : theme.dimensions.hugeSpacing)};\n  `\n)\n\ninterface TitledSurfaceProps {\n  title: React.ReactNode\n  children: React.ReactNode[]\n  compact?: boolean\n  className?: string\n}\n\nexport default function TitledSurface(props: TitledSurfaceProps) {\n  const { title, children, className, compact = false } = props\n\n  return (\n    <>\n      <PaddedTitle>{title}</PaddedTitle>\n      <PaddedSurface $compact={compact} className={className}>\n        {children}\n      </PaddedSurface>\n    </>\n  )\n}\n","import React, { ChangeEventHandler } from 'react'\nimport styled, { css } from 'styled-components'\nimport { defaultBlock } from '../../styled/mixins/layout'\nimport { defaultBorder, defaultInput } from '../../styled/mixins/theming'\n\nconst Wrapper = styled.div(\n  ({ theme }) => css`\n    width: 120px;\n    height: ${theme.dimensions.blockHeight};\n  `\n)\n\nconst StyledSelect = styled.select`\n  ${defaultInput}\n\n  width: 100%;\n  height: 100%;\n`\n\nconst Option = styled.option(\n  ({ theme }) => css`\n    ${defaultBorder({ theme })}\n    background-color: ${theme.colors.backgroundColor2};\n    ${defaultBlock({ theme })}\n  `\n)\n\ninterface SelectProps {\n  options: Record<string, string>\n  value: string\n  onChange: ChangeEventHandler\n}\n\nexport default function Select(props: SelectProps) {\n  const { options, value, onChange } = props\n\n  return (\n    <Wrapper>\n      <StyledSelect value={value} onChange={onChange}>\n        {Object.entries(options).map(([optionKey, optionValue]) => (\n          <Option key={optionKey} value={optionKey}>\n            {optionValue}\n          </Option>\n        ))}\n      </StyledSelect>\n    </Wrapper>\n  )\n}\n","import React, { ChangeEventHandler, useCallback, useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport { defaultInput } from '../../styled/mixins/theming'\n\nconst StyledInput = styled.input`\n  ${defaultInput}\n\n  width: 70px;\n  text-align: left;\n`\n\ninterface SmallTextInputProps {\n  value: string\n  onSubmit: (value: string) => void\n  className?: string\n}\n\ninterface SmallNumberInputProps {\n  value: number\n  onSubmit: (value: number) => void\n  min?: number\n  max?: number\n  step?: number\n  className?: string\n}\n\nexport function SmallTextInput(props: SmallTextInputProps) {\n  const { value, onSubmit, className } = props\n  const [internalValue, setInternalValue] = useState(value)\n\n  useEffect(() => {\n    setInternalValue(value)\n  }, [value])\n\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback((event) => {\n    setInternalValue(event.target.value)\n  }, [])\n\n  const onBlur = useCallback(() => {\n    onSubmit(internalValue)\n  }, [internalValue, onSubmit])\n\n  const blurOnEnter = useCallback((event) => {\n    if (event.key === 'Enter') {\n      event.target.blur()\n    }\n  }, [])\n\n  return (\n    <StyledInput\n      type='text'\n      value={internalValue}\n      onChange={onChange}\n      onBlur={onBlur}\n      onKeyDown={blurOnEnter}\n      className={className}\n    />\n  )\n}\n\nexport function SmallNumberInput(props: SmallNumberInputProps) {\n  const { value, onSubmit, className, min, max, step } = props\n  const [internalValue, setInternalValue] = useState(value.toString())\n\n  useEffect(() => {\n    setInternalValue(value.toString())\n  }, [value])\n\n  const onChange: ChangeEventHandler<HTMLInputElement> = useCallback((event) => {\n    setInternalValue(event.target.value)\n  }, [])\n\n  const onBlur = useCallback(() => {\n    onSubmit(Number(internalValue))\n  }, [internalValue, onSubmit])\n\n  const blurOnEnter = useCallback((event) => {\n    if (event.key === 'Enter') {\n      event.target.blur()\n    }\n  }, [])\n\n  return (\n    <StyledInput\n      type='number'\n      min={min}\n      max={max}\n      step={step}\n      value={internalValue}\n      onChange={onChange}\n      onBlur={onBlur}\n      onKeyDown={blurOnEnter}\n      className={className}\n    />\n  )\n}\n","import styled from 'styled-components'\nimport { centeredMaxWidth } from '../../styled/mixins/layout'\nimport { FlexColumnWithSpacing } from './FlexColumn'\n\nexport const DefaultPageColumn = styled(FlexColumnWithSpacing)`\n  ${centeredMaxWidth}\n  flex-grow: 1;\n`\n","import React from 'react'\nimport firebase from 'firebase'\nimport * as r34 from 'r34-types'\nimport useFirebaseAuthState from './useFirebaseAuthState'\nimport { sha256 } from '../data/encryption'\n\nexport function useSupertags() {\n  const [supertags, setSupertags] = React.useState<Record<string, r34.SupertagData>>({})\n  const [collection, setCollection] = React.useState<firebase.firestore.CollectionReference>()\n\n  const [, userInfo] = useFirebaseAuthState()\n\n  React.useEffect(() => {\n    if (userInfo?.email) {\n      sha256(userInfo.email)\n        .then((hash) => {\n          const col = firebase.firestore().collection(`users/${hash}/supertags`)\n          setCollection(col)\n          return col.get()\n        })\n        .then((snapshot) => {\n          const result = snapshot.docs.reduce((result, doc) => {\n            result[doc.id] = doc.data() as r34.SupertagData\n            return result\n          }, {} as Record<string, r34.SupertagData>)\n\n          setSupertags(result)\n        })\n        .catch((err) => {\n          console.error('Error with useSupertags', err)\n        })\n    }\n  }, [userInfo?.email])\n\n  React.useEffect(() => {\n    if (collection) {\n      const unsubscribe = collection.onSnapshot((snapshot) => {\n        const result = snapshot.docs.reduce((result, doc) => {\n          const userSupertags = doc\n          result[userSupertags.id] = doc.data() as r34.SupertagData\n          return result\n        }, {} as Record<string, r34.SupertagData>)\n\n        setSupertags(result)\n      })\n\n      return () => {\n        unsubscribe()\n      }\n    }\n  }, [collection])\n\n  return supertags\n}\n","export async function sha256(message: string) {\n  const msgBuffer = new TextEncoder().encode(message)\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\n\n  return hashHex\n}\n","import React from 'react'\nimport styled, { css } from 'styled-components'\nimport { gridWithGap } from '../../styled/mixins/layout'\nimport { SmallTitle, Faded } from './Text'\n\nconst Grid = styled.div`\n  ${gridWithGap}\n  grid-template-columns: 1fr auto;\n  grid-template-rows: auto auto;\n`\n\nconst Title = styled(SmallTitle)(\n  ({ theme }) => css`\n    grid-column: 1/2;\n    grid-row: 1/2;\n  `\n)\n\nconst Body = styled(Faded)(\n  ({ theme }) => css`\n    grid-column: 1/2;\n    grid-row: 2/3;\n  `\n)\n\nconst Control = styled.div(\n  ({ theme }) => css`\n    grid-column: 2/3;\n    grid-row: 1/3;\n  `\n)\n\ninterface SettingProps {\n  title: string\n  description: string\n  children: React.ReactNode\n}\n\nexport default function Setting({ title, description, children }: SettingProps) {\n  return (\n    <Grid>\n      <Title>{title}</Title>\n      <Body>{description}</Body>\n      <Control>{children}</Control>\n    </Grid>\n  )\n}\n","import { useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport { signIn, signOut } from '../../client/firebase'\nimport useFirebaseAuthState from '../../hooks/useFirebaseAuthState'\nimport { GoogleIcon, SignOutIcon } from '../../icons/FontAwesomeIcons'\nimport { flexRowWithGap } from '../../styled/mixins/layout'\nimport { PrimaryButton } from '../designsystem/Buttons'\nimport { FlexColumn } from '../designsystem/FlexColumn'\n\nconst FlexRow = styled.div`\n  ${flexRowWithGap}\n`\n\nconst ProfilePicture = styled.img(\n  ({ theme }) => css`\n    height: ${theme.dimensions.blockHeight};\n    width: ${theme.dimensions.blockHeight};\n    border-radius: ${theme.dimensions.borderRadius};\n  `\n)\n\nexport default function SignIn() {\n  const [isSignedIn, user] = useFirebaseAuthState()\n  const handleSignIn = useCallback(signIn, [])\n  const handleSignOut = useCallback(signOut, [])\n\n  if (isSignedIn) {\n    const name = user?.displayName || user?.email || ''\n    const picture = user?.photoURL || ''\n\n    return (\n      <FlexColumn>\n        <FlexRow>\n          <ProfilePicture src={picture} alt={name} title={name} />\n          <PrimaryButton onClick={handleSignOut}>\n            <SignOutIcon />\n            <span>Sign Out</span>\n          </PrimaryButton>\n        </FlexRow>\n      </FlexColumn>\n    )\n  }\n\n  return (\n    <PrimaryButton onClick={handleSignIn}>\n      <GoogleIcon />\n      <span>Sign In</span>\n    </PrimaryButton>\n  )\n}\n","import React from 'react'\nimport Setting from '../designsystem/Setting'\nimport SignIn from '../widgets/SignIn'\n\nexport default function PrefAccount() {\n  return (\n    <Setting\n      title='Account'\n      description='Sign in to save your preferences across devices. Some preferences require you to be signed in because they use your stored data.'\n    >\n      <SignIn />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefAutoPlay() {\n  const [autoPlay, setAutoPlay] = usePreference('autoPlay')\n  const toggleAutoPlay = useCallback(() => setAutoPlay(!autoPlay), [autoPlay, setAutoPlay])\n\n  return (\n    <Setting\n      title='Auto-play'\n      description='Start videos automatically once they become visible. This will use more data.'\n    >\n      <Toggle value={autoPlay} onToggle={toggleAutoPlay} />\n    </Setting>\n  )\n}\n","import React from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport { SmallNumberInput } from '../designsystem/SmallInput'\n\nexport default function PrefAutoscrollDelay() {\n  const [autoscrollDelay, setAutoscrollDelay] = usePreference('autoscrollDelay')\n\n  return (\n    <Setting\n      title='Autoscroll delay'\n      description='Configure how long posts stay on screen in fullscreen view. Time in seconds'\n    >\n      <SmallNumberInput value={autoscrollDelay} onSubmit={setAutoscrollDelay} min={1} max={60} step={1} />\n    </Setting>\n  )\n}\n","import { useCallback, useEffect } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Select from '../designsystem/Select'\nimport Setting from '../designsystem/Setting'\n\nconst BACKEND_TYPES = {\n  default: 'Default',\n  adaptable: 'Adaptable',\n  render: 'Render',\n}\n\nconst BACKEND_URLS: Record<string, string[]> = {\n  default: ['https://json-api.onrender.com'],\n  adaptable: ['https://rule34-json-api.adaptable.app'],\n  render: ['https://json-api.onrender.com'],\n}\n\nexport default function PrefBackends() {\n  const [backends, setBackends] = usePreference('backends')\n\n  const preferedBackend = Object.keys(BACKEND_URLS).find(\n    (key) => backends && BACKEND_URLS[key].includes(backends[0])\n  ) as keyof typeof BACKEND_TYPES\n\n  const onChange = useCallback(\n    (event) => {\n      const value: keyof typeof BACKEND_TYPES = event.target.value\n      setBackends(BACKEND_URLS[value] ?? BACKEND_URLS.default)\n    },\n    [setBackends]\n  )\n\n  useEffect(() => {\n    if(preferedBackend === undefined) {\n      setBackends(BACKEND_URLS.default)\n    }\n  })\n\n  return (\n    <>\n      <Setting title='Backend' description='Controls the backend used to fetch posts.'>\n        <Select options={BACKEND_TYPES} value={preferedBackend ?? BACKEND_TYPES.default} onChange={onChange} />\n      </Setting>\n    </>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefHideSeenPosts() {\n  const [hideSeen, setHideSeen] = usePreference('hideSeen')\n  const toggleHideSeen = useCallback(() => setHideSeen(!hideSeen), [hideSeen, setHideSeen])\n\n  return (\n    <Setting\n      title='Hide seen posts [NOT WORKING]'\n      description='Enabling this option will hide all posts you have seen before. Perfect if you are frequently browsing the same tags or sorting by score.'\n    >\n      <Toggle value={hideSeen} onToggle={toggleHideSeen} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefLoadOriginals() {\n  const [originals, setOriginals] = usePreference('originals')\n  const toggleOriginals = useCallback(() => setOriginals(!originals), [originals, setOriginals])\n  return (\n    <Setting\n      title='Load original sizes'\n      description='Display images and videos at their original resolution. This will consume more data but provides a nicer experience.'\n    >\n      <Toggle value={originals} onToggle={toggleOriginals} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefMetadata() {\n  const [showMetadata, setShowMetadata] = usePreference('showMetadata')\n  const toggleShowMetadata = useCallback(() => setShowMetadata(!showMetadata), [showMetadata, setShowMetadata])\n\n  return (\n    <Setting\n      title='Show post metadata'\n      description=\"Posts display more data in their details. Mainly for developing purposes but maybe it's useful to someone.\"\n    >\n      <Toggle value={showMetadata} onToggle={toggleShowMetadata} />\n    </Setting>\n  )\n}\n","import React from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport { SmallNumberInput } from '../designsystem/SmallInput'\n\nexport default function PrefPageSize() {\n  const [pageSize, setPageSize] = usePreference('pageSize')\n\n  return (\n    <Setting title='Page size' description='Controls the number of posts loaded at once.'>\n      <SmallNumberInput value={pageSize} onSubmit={setPageSize} min={10} max={200} step={1} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefPreloadVideos() {\n  const [preloadVideos, setPreloadVideos] = usePreference('preloadVideos')\n  const togglePreloadVideos = useCallback(() => setPreloadVideos(!preloadVideos), [preloadVideos, setPreloadVideos])\n\n  return (\n    <Setting\n      title='Preload Animations'\n      description='Start loading videos and gifs immediately instead of when you click play. This will improve your viewing experience but will consume a LOT of data. Only use with WIFI.'\n    >\n      <Toggle value={preloadVideos} onToggle={togglePreloadVideos} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { ResultsLayout } from 'r34-types'\nimport usePreference from '../../hooks/usePreference'\nimport Select from '../designsystem/Select'\nimport Setting from '../designsystem/Setting'\n\nconst layouts: Record<ResultsLayout, string> = {\n  infinite_column: 'Infinite',\n  pages: 'Pages',\n}\n\nexport default function PrefResultsLayout() {\n  const [resultsLayout, setResultsLayout] = usePreference('resultsLayout')\n  const onChangeResultsLayout = useCallback((event) => setResultsLayout(event.target.value), [setResultsLayout])\n\n  return (\n    <Setting title='Results Layout' description='Choose how your results are displayed.'>\n      <Select options={layouts} value={resultsLayout} onChange={onChangeResultsLayout} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefShowComments() {\n  const [showComments, setShowComments] = usePreference('showComments')\n  const toggleShowComments = useCallback(() => setShowComments(!showComments), [showComments, setShowComments])\n\n  return (\n    <Setting\n      title='Show comments'\n      description=\"If there are comments on a post, they will appear in the details. This preference needs 'Show Post Details' to be enabled to have any effect.\"\n    >\n      <Toggle value={showComments} onToggle={toggleShowComments} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport Toggle from '../designsystem/Toggle'\n\nexport default function PrefShowPostDetails() {\n  const [showPostDetails, setShowPostDetails] = usePreference('showPostDetails')\n  const toggleShowPostDetails = useCallback(\n    () => setShowPostDetails(!showPostDetails),\n    [showPostDetails, setShowPostDetails]\n  )\n\n  return (\n    <Setting\n      title='Show post details'\n      description='When enabled, tapping a post shows additional details for the post. This includes tags, rating, likes, the artist and more.'\n    >\n      <Toggle value={showPostDetails} onToggle={toggleShowPostDetails} />\n    </Setting>\n  )\n}\n","import { useCallback } from 'react'\nimport { removeSupertag, setTagsOfSupertag } from '../client/firebase'\nimport * as r34 from 'r34-types'\n\nexport const useSupertag = (supertag: r34.Supertag) => {\n  const addTag = useCallback(\n    (newTag: r34.AnyBiasedTag) => {\n      const tag = newTag as r34.BiasedTag\n      const newTags = { ...supertag.tags, [tag.name]: tag.modifier }\n      setTagsOfSupertag(supertag.name, newTags)\n    },\n    [supertag.name, supertag.tags]\n  )\n  const removeTag = useCallback(\n    (tag: r34.AnyTag) => {\n      const newTags = { ...supertag.tags }\n      delete newTags[tag.name]\n      setTagsOfSupertag(supertag.name, newTags)\n    },\n    [supertag.name, supertag.tags]\n  )\n  const deleteSupertag = useCallback(() => removeSupertag(supertag.name), [supertag.name])\n\n  return [addTag, removeTag, deleteSupertag] as const\n}\n","import React, { useMemo } from 'react'\nimport styled, { css } from 'styled-components'\nimport useToggle from '../../hooks/useToggle'\nimport { CloseIcon, ShareIcon, SupertagIcon } from '../../icons/FontAwesomeIcons'\nimport TagList from '../tag/TagList'\nimport TagSelector from '../tagSelector/TagSelector'\nimport { Faded } from './Text'\nimport * as r34 from 'r34-types'\nimport { useSupertag } from '../../hooks/useSupertag'\nimport { Link } from 'react-router-dom'\nimport { RouteName } from '../../data/types'\nimport { encodeSupertag, isSupertag } from '../../data/tagUtils'\nimport { InvisButton } from './Buttons'\nimport { flexColumnWithGap, gridWithGap } from '../../styled/mixins/layout'\n\nconst Wrapper = styled.div(\n  ({ theme }) => css`\n    ${flexColumnWithGap}\n\n    padding-block: ${theme.dimensions.bigSpacing};\n\n    :not(:last-child) {\n      border-bottom: solid gray 1px;\n    }\n\n    :active {\n      background: ${theme.colors.layerBgHighlight};\n    }\n  `\n)\n\nconst Row = styled.div`\n  ${gridWithGap}\n  grid-template-columns: auto auto 1fr auto auto;\n  grid-template-rows: 1fr auto;\n  align-items: center;\n  cursor: pointer;\n\n  > :first-child {\n    place-items: center;\n    grid-area: 1/1/3/2;\n  }\n  > :nth-child(2) {\n    grid-area: 1/2/2/3;\n  }\n  > :nth-child(3) {\n    grid-area: 1/3/2/4;\n  }\n  > :nth-child(4) {\n    grid-area: 2/2/3/4;\n  }\n  > :nth-child(5) {\n    grid-area: 1/4/3/5;\n  }\n  > :nth-child(6) {\n    grid-area: 1/6/3/6;\n  }\n`\n\nconst LinkButton = styled(Link)(\n  ({ theme }) => css`\n    padding: ${theme.dimensions.bigSpacing};\n    cursor: pointer;\n    color: ${theme.colors.text};\n  `\n)\n\ninterface SupertagEntryProps {\n  supertag: r34.Supertag\n}\n\nexport default function SupertagEntry(props: SupertagEntryProps) {\n  const { supertag } = props\n  const { name, description, tags } = supertag\n\n  const [isOpen, toggleOpen] = useToggle()\n  const [addTag, removeTag, deleteSupertag] = useSupertag(supertag)\n\n  const tagObjects = useMemo(\n    () =>\n      Object.entries(tags).reduce((result, [name, modifier]) => {\n        result[name] = { name, modifier, types: [] }\n        return result\n      }, {} as Record<string, Omit<r34.BiasedTag, 'count'>>),\n    [tags]\n  )\n\n  const handleRemove = React.useCallback(\n    (event) => {\n      event.stopPropagation()\n      event.preventDefault()\n      deleteSupertag()\n    },\n    [deleteSupertag]\n  )\n\n  const onTagMenu = React.useCallback(\n    (tag: r34.AnyBiasedTag) => {\n      if (!isSupertag(tag)) {\n        const order: r34.TagModifier[] = ['+', '-', '~']\n        const nextModifer = order[(order.indexOf(tag.modifier) + 1) % 3]\n        addTag({ ...tag, modifier: nextModifer })\n      }\n    },\n    [addTag]\n  )\n\n  return (\n    <Wrapper>\n      <Row onClick={toggleOpen} title='Open supertag details'>\n        <SupertagIcon />\n        <span>{name}</span>\n        <Faded>{Object.keys(tags).length} tags</Faded>\n        <Faded>{description}</Faded>\n        <LinkButton to={`${RouteName.SHARE}?${encodeSupertag(supertag)}`} title='Share supertag'>\n          <ShareIcon />\n        </LinkButton>\n        <InvisButton onClick={handleRemove} title='Delete supertag'>\n          <CloseIcon />\n        </InvisButton>\n      </Row>\n\n      {isOpen && (\n        <>\n          <TagSelector onSubmit={addTag} showSupertags={false} />\n          <TagList tags={tagObjects} detailed={false} onTagClick={removeTag} onTagMenu={onTagMenu}></TagList>\n        </>\n      )}\n    </Wrapper>\n  )\n}\n","import React from 'react'\nimport { useDispatch } from 'react-redux'\nimport { ModalId } from '../../data/types'\nimport { useSupertags } from '../../hooks/useSupertags'\nimport { PlusIcon } from '../../icons/FontAwesomeIcons'\nimport { openModal } from '../../redux/actions'\nimport { PrimaryButton } from '../designsystem/Buttons'\nimport Setting from '../designsystem/Setting'\nimport SupertagEntry from '../designsystem/SupertagEntry'\n\nexport default function PrefSupertags() {\n  const supertags = useSupertags()\n\n  const dispatch = useDispatch()\n  const openSupertagModal = React.useCallback(() => dispatch(openModal(ModalId.CREATE_SUPERTAG)), [dispatch])\n\n  return (\n    <>\n      <Setting\n        title='Supertags'\n        description='You can manage your supertags here. To create on sign in and try adding two or more tags to your search. Adding supertag to your search will add all the tags inside instead.'\n      >\n        <PrimaryButton onClick={openSupertagModal}>\n          <PlusIcon /> Add new\n        </PrimaryButton>\n      </Setting>\n      <div>\n        {Object.entries(supertags).map(([name, details]) => (\n          <SupertagEntry key={name} supertag={{ name, ...details }}></SupertagEntry>\n        ))}\n      </div>\n    </>\n  )\n}\n","import React from 'react'\nimport usePreference from '../../hooks/usePreference'\nimport Setting from '../designsystem/Setting'\nimport { SmallNumberInput } from '../designsystem/SmallInput'\n\nexport default function PrefTagSuggestions() {\n  const [tagSuggestionsCount, setTagSuggestionsCount] = usePreference('tagSuggestionsCount')\n\n  return (\n    <Setting\n      title='Number of Tag suggestions'\n      description='Controls the number of tags displayed when searching. Increase this when searching for niche tags.'\n    >\n      <SmallNumberInput value={tagSuggestionsCount} onSubmit={setTagSuggestionsCount} min={3} max={200} step={1} />\n    </Setting>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { Theme } from 'r34-types'\nimport usePreference from '../../hooks/usePreference'\nimport Select from '../designsystem/Select'\nimport Setting from '../designsystem/Setting'\n\nconst themes: Record<Theme, string> = {\n  dark: 'Dark',\n  light: 'Light',\n  coffee: 'Coffee',\n  deepsea: 'Deep Sea',\n}\n\nexport default function PrefTheme() {\n  const [themeId, setThemeId] = usePreference('themeId')\n  const changeTheme = useCallback((event) => setThemeId(event.target.value), [setThemeId])\n\n  return (\n    <Setting title='Theme' description='Choose how the app looks.'>\n      <Select options={themes} value={themeId} onChange={changeTheme} />\n    </Setting>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport { FailedIcon, SuccessIcon } from '../../icons/FontAwesomeIcons'\n\nconst Positive = styled(SuccessIcon).attrs((props) => ({\n  color: props.theme.colors.positive,\n}))``\n\nconst Negative = styled(FailedIcon).attrs((props) => ({\n  color: props.theme.colors.negative,\n}))``\n\ntype StatusImageProps = {\n  value: boolean\n}\n\nexport default function StatusImage(props: StatusImageProps) {\n  return props.value ? <Positive /> : <Negative />\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport {\n  supportsAspectRatio,\n  supportsFlexGap,\n  supportsFullscreen,\n  supportsGap,\n  supportsLocalStorage,\n  supportsNetworkInformationAPI,\n  supportsObjectFit,\n} from '../../data/browserUtils'\nimport { defaultSpacing } from '../../styled/mixins/gap'\nimport { flexColumnWithGap } from '../../styled/mixins/layout'\nimport { borderRadius } from '../../styled/mixins/theming'\nimport StatusImage from '../designsystem/StatusImage'\nimport { SmallTitle, Faded } from '../designsystem/Text'\n\nconst Wrapper = styled.div`\n  ${flexColumnWithGap}\n`\n\nconst FeatureList = styled.div`\n  ${flexColumnWithGap}\n  ${defaultSpacing}\n  ${borderRadius}\n  background: ${(props) => props.theme.colors.backgroundColor};\n`\n\nexport default function FeatureDetection() {\n  return (\n    <Wrapper>\n      <SmallTitle>Feature Detection</SmallTitle>\n      <Faded>This information is really valuable when investigating layout and browser issues.</Faded>\n      <FeatureList>\n        <Faded>\n          <StatusImage value={supportsGap} /> Supports grid-gap\n        </Faded>\n        <Faded>\n          <StatusImage value={supportsFlexGap} /> Supports flex-gap\n        </Faded>\n        <Faded>\n          <StatusImage value={supportsAspectRatio} /> Supports aspect-ratio\n        </Faded>\n        <Faded>\n          <StatusImage value={supportsObjectFit} /> Supports object-fit\n        </Faded>\n        <Faded>\n          <StatusImage value={supportsFullscreen} /> Supports fullscreen\n        </Faded>\n        <Faded>\n          <StatusImage value={supportsNetworkInformationAPI} /> Supports advanced network info\n        </Faded>\n        <Faded>\n          <StatusImage value={supportsLocalStorage} /> Supports localStorage\n        </Faded>\n      </FeatureList>\n    </Wrapper>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\nimport { setPosts } from '../../redux/actions'\nimport { BlockButton } from '../designsystem/Buttons'\n\nexport default function ResetResultsButton() {\n  const dispatch = useDispatch()\n\n  const handleClick = useCallback(() => dispatch(setPosts([], 0, 0)), [dispatch])\n\n  return (\n    <BlockButton onClick={handleClick}>\n      <UndoIcon /> Reset Results\n    </BlockButton>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { resetSeenPosts } from '../../client/firebase'\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\nimport { BlockButton } from '../designsystem/Buttons'\n\nexport default function ResetSeenPostsButton() {\n  const onResetSeenPosts = useCallback(resetSeenPosts, [])\n\n  return (\n    <BlockButton onClick={onResetSeenPosts}>\n      <UndoIcon /> Reset seen posts\n    </BlockButton>\n  )\n}\n","import styled, { useTheme } from 'styled-components'\nimport { getVersionString } from '../../data/utils'\nimport useFirebaseAuthState from '../../hooks/useFirebaseAuthState'\nimport { usePageTitle } from '../../hooks/usePageTitle'\nimport { CodeBranchIcon } from '../../icons/FontAwesomeIcons'\nimport { flexRowWithGap } from '../../styled/mixins/layout'\nimport { DefaultPageColumn } from '../designsystem/DefaultPageColumn'\nimport { FlexColumn } from '../designsystem/FlexColumn'\nimport { HorizontalLine } from '../designsystem/Lines'\nimport { Faded } from '../designsystem/Text'\nimport TitledSurface from '../designsystem/TitledSurface'\nimport Header from '../features/Header'\nimport PrefAccount from '../preferences/PrefAccount'\nimport PrefAutoPlay from '../preferences/PrefAutoPlay'\nimport PrefAutoscrollDelay from '../preferences/PrefAutoscrollDelay'\nimport PrefBackends from '../preferences/PrefBackends'\nimport PrefHideSeenPosts from '../preferences/PrefHideSeenPosts'\nimport PrefLoadOriginals from '../preferences/PrefLoadOriginals'\nimport PrefMetadata from '../preferences/PrefMetadata'\nimport PrefPageSize from '../preferences/PrefPageSize'\nimport PrefPreloadVideos from '../preferences/PrefPreloadVideos'\nimport PrefResultsLayout from '../preferences/PrefResultsLayout'\nimport PrefShowComments from '../preferences/PrefShowComments'\nimport PrefShowPostDetails from '../preferences/PrefShowPostDetails'\nimport PrefSupertags from '../preferences/PrefSupertags'\nimport PrefTagSuggestions from '../preferences/PrefTagSuggestions'\nimport PrefTheme from '../preferences/PrefTheme'\nimport FeatureDetection from '../widgets/FeatureDetection'\nimport ResetButton from '../widgets/ResetButton'\nimport ResetResultsButton from '../widgets/ResetResultsButton'\nimport ResetSeenPostsButton from '../widgets/ResetSeenPostsButton'\n\nconst VersionWrapper = styled.div`\n  ${flexRowWithGap}\n  flex-grow: 1;\n  justify-content: center;\n  min-height: 50px;\n`\n\nexport default function Preferences() {\n  const theme = useTheme()\n  const versionString = getVersionString()\n  const [isSignedIn] = useFirebaseAuthState()\n\n  usePageTitle('Rule34 React - Preferences')\n\n  return (\n    <FlexColumn>\n      <Header />\n      <DefaultPageColumn>\n        <TitledSurface title='General'>\n          <PrefResultsLayout />\n          <PrefPreloadVideos />\n          <PrefLoadOriginals />\n          <PrefTagSuggestions />\n          <PrefPageSize />\n          <PrefShowPostDetails />\n          <PrefShowComments />\n        </TitledSurface>\n\n        <TitledSurface title='Account'>\n          <PrefAccount />\n          <PrefTheme />\n          {isSignedIn && (\n            <>\n              <PrefSupertags />\n              <PrefHideSeenPosts />\n            </>\n          )}\n        </TitledSurface>\n\n        <TitledSurface title='Experimental'>\n          <Faded>\n            These features that are still under active development. They might change a lot in the future. Please report\n            any bugs you find so I can fix them :)\n          </Faded>\n          <HorizontalLine />\n          <PrefAutoPlay />\n          <PrefAutoscrollDelay />\n        </TitledSurface>\n        <TitledSurface title='Developer'>\n          <PrefMetadata />\n          <PrefBackends />\n          <FeatureDetection />\n          <ResetResultsButton />\n          <ResetSeenPostsButton />\n          <ResetButton />\n        </TitledSurface>\n\n        <VersionWrapper>\n          <CodeBranchIcon color={theme.colors.subduedText} />\n          <Faded>{versionString}</Faded>\n        </VersionWrapper>\n      </DefaultPageColumn>\n    </FlexColumn>\n  )\n}\n"],"sourceRoot":""}